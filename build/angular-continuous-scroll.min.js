/*!
 * angular-continuous-scroll.js v0.1.8
 * https://github.com/fabianweb/angular-continuous-scroll
 * Original work Copyright 2014 David Chin
 * Modified work Copyright 2015-2016 Fabian Pirklbauer
 * MIT License
 */
!function(){"use strict";angular.module("fw.continuousScroll",[])}(),function(){"use strict";angular.module("fw.continuousScroll").directive("continuousScroll",["$window","$timeout","$compile",function(a,b,c){function d(a,c){var d,e=new Date(Date.now()+c);return function(){var f=arguments,g=new Date;g>=e?(d&&b.cancel(d),d=void 0,e=new Date(Date.now()+c),a.apply(this,f)):d||(d=b(function(){d=void 0,e=new Date(Date.now()+c),a.apply(this,f)},c))}}function e(a){var b=a.match(h);return{item:b[1],collection:b[2],trackBy:b[3]}}function f(b,c,d){var f={offset:-100,throttle:300,perPage:20,initialPage:1};this.initialized=!1,this.scope=b,this.attrs=d,this.element=$(c),this.options=angular.extend({},f,this.scope.$eval(this.attrs.scrollerOpts)),this.docWindow=$(a),this.window=this.options.window?$(this.options.window):this.docWindow,this.dimension={window:{},parent:{},items:[]},this.status={},this.expression=e(this.attrs.continuousScroll),this.placeholder=null,this.placeholderBottom=null,this.initialPage=parseInt(this.scope.initialPage||this.options.initialPage,10),this.loadedPages=0,this.perPage=parseInt(this.scope.perPage||this.options.perPage,10),this.currentPage=this.initialPage,this.updatedDefault={unshifted:!1,unshiftedCount:0,pushed:!1,pushedCount:0},this.updated=JSON.parse(JSON.stringify(this.updatedDefault)),this._watch()}function g(a,b){this.html=this._create(a,b)}var h=/^\s*(.+)\s+in\s+([\r\n\s\S]*?)\s*(\s+track\s+by\s+(.+)\s*)?$/;return f.prototype.check=function(){angular.extend(this.status,this._getScrollStatus()),this.dimension.window=this._getDimension("window"),this.dimension.parent=this._getDimension("parent"),this.clean(),this.status.isEndReached&&this.status.isScrollingDown&&this.dimension.parent.bottom+this.options.offset<=this.dimension.window.bottom&&this.next(),this.status.isStartReached&&this.status.isScrollingUp&&this.dimension.parent.top-this.options.offset>=this.dimension.window.top&&this.previous()},f.prototype.next=function(){this.status.isPendingNext||(this._setPending("next",!0),this.scope.$emit("scroller.page:next",this))},f.prototype.previous=function(){this.status.isPendingPrevious||(this._setPending("previous",!0),this.scope.$emit("scroller.page:previous",this))},f.prototype.update=function(a){var c,d,e,f,g,h,i;if(g=this.previousOriginalItems,this.originalItems=a,angular.isArray(a)&&angular.isArray(g)){for(h=0,i=a.length;i>h;h++)if(a[h]===g[0]&&void 0!==a[h]){e=h;break}for(h=a.length-1;h>=0;h--)if(a[h]===g[g.length-1]&&void 0!==a[h]){f=h;break}e&&(c=a.slice(0,e)),f&&(d=a.slice(f+1))}angular.isArray(this.items)&&0!==this.items.length?(c&&(this.items.unshift.apply(this.items,c),this.dimension.items.unshift.apply(this.dimension.items,new Array(c.length)),this.initialPage>1&&b(angular.bind(this,function(){this.initialPage--}))),d&&(this.items.push.apply(this.items,d),this.dimension.items.push.apply(this.dimension.items,new Array(d.length)))):angular.isArray(a)&&(this.items=a.slice()),this.updated={unshifted:!!c,unshiftedCount:c?c.length:0,pushed:!!d,pushedCount:d?d.length:0},angular.isArray(a)&&(this.previousOriginalItems=a.slice()),b(angular.bind(this,function(){this._setPending("next",!1),this._setPending("previous",!1),angular.isArray(a)&&angular.isArray(g)&&this.check()}))},f.prototype.init=function(){var a,b,c,d;b=this._getParent(),a={visibility:"hidden",padding:0,border:0},c=this._getChildren(),d=c.get(0)&&c.prop("tagName").toLowerCase(),!this.placeholder&&d&&(this.placeholder=$("<"+d+">"),this.placeholder.css(a).prependTo(b)),this.placeholderBottom||(this.placeholderBottom=$("<"+d+">"),a.clear="both",this.placeholderBottom.css(a).appendTo(b)),this.initialized=!0},f.prototype.clean=function(){var a,b,c,d,e,f;if(this.dimension.items=this._getDimension("items"),this.updated.unshifted===!0){var g=this.dimension.items[0],h=this.dimension.items[this.updated.unshiftedCount-1],i=-1*g.top+h.top,j=-1*g.bottom+h.bottom;for(f=this.items.length-1;f<this.dimension.items.length;f++)this.dimension.items[f].top+=i,this.dimension.items[f].bottom+=j}if(this.dimension.items&&this.originalItems&&this.dimension.items.length===this.originalItems.length&&(this.initialized===!1&&this.init(),angular.forEach(this.dimension.items,function(c,d){var e=c.bottom>=this.dimension.window.top-this.dimension.window.height&&c.top<=this.dimension.window.bottom+this.dimension.window.height;e&&(void 0===a&&(a=d),b=d)},this),c=void 0!==a?this.dimension.items[a].top-this.dimension.parent.top:0,d=void 0!==b?this.dimension.items[this.dimension.items.length-1].bottom-this.dimension.items[b].bottom:0,this.placeholder&&this.placeholder.height(c),this.placeholderBottom&&this.placeholderBottom.height(d),void 0!==a&&void 0!==b&&angular.isArray(this.items)&&angular.isArray(this.originalItems))){e=this.originalItems.slice(a,b+1),this.items.splice.apply(this.items,[0,this.items.length].concat(e));var k=this.currentPage;this.loadedPages=Math.ceil(this.originalItems.length/this.perPage),this.currentPage=Math.round(a/this.perPage)+this.initialPage,k!==this.currentPage&&this.scope.$emit("scroller.page:update",this)}this.updated=JSON.parse(JSON.stringify(this.updatedDefault))},f.prototype._watch=function(){var a=this.expression.collection;a&&(this.scope.$watchCollection(a,angular.bind(this,function(){this.update.apply(this,arguments)})),this.window.on("scroll",this._boundOnScroll=angular.bind(this,this._onScroll)),this.scope.$on("$destroy",angular.bind(this,this._unwatch)))},f.prototype._unwatch=function(){this._boundOnScroll&&this.window.off("scroll",this._boundOnScroll)},f.prototype._setPending=function(a,c){var d="isPending"+a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();this.status[d]=angular.isUndefined(c)?!0:!!c,this.timeouts=this.timeouts||{},this.status[d]&&(this.timeouts[d]&&(b.cancel(this.timeouts[d]),delete this.timeouts[d]),this.timeouts[d]=b(angular.bind(this,function(){this.status[d]=!1}),5e3))},f.prototype._onScroll=function(){this.scope.$apply(angular.bind(this,function(){this._throttledCheck||(this._throttledCheck=d(angular.bind(this,this.check),this.options.throttle)),this._throttledCheck()}))},f.prototype._getParent=function(){return this._parent&&this._parent.get(0)||(this._parent=this.element.parent()),this._parent},f.prototype._getOffsetTop=function(b){var c=b.offset();return this.window.get(0)===a?c.top:c.top+this.window.scrollTop()-this.docWindow.scrollTop()},f.prototype._getDimension=function(a){var b,c,d,e=this._getParent();switch(a){case"window":return b=this.window.outerHeight(),c=this.window.scrollTop(),d=c+b,{height:b,top:c,bottom:d};case"parent":return b=e.outerHeight(),c=e.get(0)&&this._getOffsetTop(e),d=c+b,{height:b,top:c,bottom:d};case"items":var f,g=this.dimension.items.slice();return this._getChildren().each(angular.bind(this,function(a,e){e=$(e),b=e.outerHeight(),c=e.get(0)&&this._getOffsetTop(e),d=c+b,f=$.inArray(e[0].getScope()[this.expression.item],this.originalItems),f>-1&&(g[f]={height:b,top:c,bottom:d})})),g}},f.prototype._getScrollStatus=function(){var a=this.window.scrollTop(),b={};return this.dimension.window.top>0?(b.isScrollingUp=a-this.dimension.window.top<0,b.isScrollingDown=a-this.dimension.window.top>0):(b.isScrollingUp=!1,b.isScrollingDown=!0),angular.isArray(this.items)&&angular.isArray(this.originalItems)?(b.isEndReached=this.items[this.items.length-1]===this.originalItems[this.originalItems.length-1],b.isStartReached=this.items[0]===this.originalItems[0]):(b.isEndReached=!0,b.isStartReached=!1),b},f.prototype._getChildren=function(){var a="[ng-repeat]";return this._getParent().children(a)},g.prototype.toString=function(){return this.html},g.prototype._create=function(a,b){var c=Array.prototype.slice.call(a.prop("attributes"),0),d=e(b.continuousScroll),f=d.item+" in _endlessScroll.items"+(d.trackBy?" "+d.trackBy:"");return angular.forEach(c,function(b){a.removeAttr(b.name)}),a.attr("ng-repeat",f),a.attr("data-exposes-scope",""),a.prop("outerHTML")},{restrict:"A",scope:!0,replace:!0,terminal:!0,priority:1e3,template:function(a,b){return new g(a,b).toString()},controller:["$scope","$element","$attrs",function(a,b,c){var d=new f(a,b,c);return a._endlessScroll=d,d}]}}])}(),function(){"use strict";angular.module("fw.continuousScroll").directive("exposesScope",function(){return{link:function(a,b,c){b[0].getScope=function(){return a}}}})}();